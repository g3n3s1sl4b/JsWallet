name: e2e-tests
on:
  pull_request:
    # branches: [testnet]
# concurrency:
#   group: e2e-tests-${{github.event.pull_request.number}}
#   cancel-in-progress: true
jobs:
  e2e-tests:
    # runs-on: ubuntu-latest
    runs-on: macos-internal2
    defaults:
      run:
        working-directory: ./e2e
    steps:
      - uses: actions/checkout@v2
      - name: clone web3t > install modules > copy to JsWallet
        working-directory: ./
        run: cd .. && git clone git@github.com:velas/web3t.git && cd web3t && npm i && cd .. && cp -pr web3t/ JsWallet/.compiled-ssr/web3t/
      - name: run wallet
        working-directory: ./
        run: npm run wallet-start
      - name: pwd
        run: pwd
      - name: install modules required for testrun
        run: npm ci
      - name: run tests
        run: npm test

      # RUN IN DOCKER
      # - name: prepare
      #   run: docker build -t wallet-tests .
      # - name: run tests
      #   run: docker run wallet-tests /bin/bash -c "npm test"
